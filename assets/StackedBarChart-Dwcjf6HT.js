import{j as o}from"./jsx-runtime-BYYWji4R.js";import{r as b}from"./index-ClcD9ViR.js";import{c as M}from"./cn-CytzSlOG.js";const A=400,$=300,f={top:20,right:20,bottom:40,left:60};function q(v){const{data:c,maxValue:u,showGrid:T=!0,gridLines:x=5}=v,[V,j]=b.useState(null),d=A-f.left-f.right,y=$-f.top-f.bottom,m=b.useMemo(()=>c.map(r=>({...r,total:r.values.reduce((e,p)=>e+p.value,0)})),[c]),i=b.useMemo(()=>u!==void 0?u:Math.max(...m.map(r=>r.total),0),[m,u]),n=b.useMemo(()=>{const r=c.length,e=12,p=e*(r-1),a=(d-p)/r;return m.map((s,l)=>{let h=f.top+y;const D=s.values.map((g,N)=>{const k=g.value/i*y,L=h-k,w={id:g.id,x:f.left+l*(a+e),y:L,width:a,height:k,value:g.value,label:g.label,color:g.color||`var(--color-primary-${(N+1)*100})`};return h=L,w});return{label:s.label,segments:D,totalValue:s.total}})},[m,i,d,y,c.length]),H=b.useMemo(()=>{if(!T)return[];const r=[];for(let e=0;e<=x;e++)r.push(i/x*e);return r},[T,x,i]);return{bars:n,maxValue:i,gridLines:H,hoveredSegment:V,setHoveredSegment:j}}const G=450,W=300,t={top:20,right:20,bottom:40,left:60};function E({data:v,maxValue:c,showGrid:u=!0,gridLines:T=5,showLabels:x=!0,className:V,width:j=G,height:d=W}){var p;const{bars:y,maxValue:m,gridLines:i,hoveredSegment:n,setHoveredSegment:H}=q({data:v,maxValue:c,showGrid:u,gridLines:T}),r=j-t.left-t.right,e=d-t.top-t.bottom;return o.jsx("div",{className:M("inline-block",V),children:o.jsxs("svg",{width:j,height:d,className:"select-none",style:{overflow:"visible"},children:[u&&i.map((a,s)=>{const l=t.top+e-a/m*e;return o.jsxs("g",{children:[o.jsx("line",{x1:t.left,y1:l,x2:t.left+r,y2:l,stroke:"var(--border-subtle)",strokeWidth:"1",strokeDasharray:"4 2"}),o.jsx("text",{x:t.left-8,y:l+4,textAnchor:"end",className:"text-[10px]",fill:"var(--text-tertiary)",children:Math.round(a)})]},`grid-${s}`)}),y.map((a,s)=>o.jsxs("g",{children:[a.segments.map((l,h)=>{const D=(n==null?void 0:n.barIndex)===s&&(n==null?void 0:n.segmentIndex)===h;return o.jsx("rect",{x:l.x,y:l.y,width:l.width,height:l.height,fill:l.color,className:M("transition-all duration-150 cursor-pointer",n&&!D&&"opacity-40"),onMouseEnter:()=>H({barIndex:s,segmentIndex:h}),onMouseLeave:()=>H(null)},`segment-${h}`)}),x&&o.jsx("text",{x:a.segments[0].x+a.segments[0].width/2,y:t.top+e+20,textAnchor:"middle",className:"text-xs font-medium",fill:"var(--text-secondary)",children:a.label})]},`bar-${s}`)),o.jsx("line",{x1:t.left,y1:t.top+e,x2:t.left+r,y2:t.top+e,stroke:"var(--border-default)",strokeWidth:"2"}),o.jsx("g",{transform:`translate(${t.left}, ${d+20})`,children:(p=v[0])==null?void 0:p.values.map((a,s)=>o.jsxs("g",{transform:`translate(${s*100}, 0)`,children:[o.jsx("rect",{width:10,height:10,fill:a.color||`var(--color-primary-${(s+1)*100})`}),o.jsx("text",{x:15,y:10,className:"text-[10px]",fill:"var(--text-secondary)",children:a.label})]},s))})]})})}E.__docgenInfo={description:"",methods:[],displayName:"StackedBarChart",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"StackedDataPoint"}],raw:"StackedDataPoint[]"},description:""},maxValue:{required:!1,tsType:{name:"number"},description:""},showGrid:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},gridLines:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5",computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},width:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"450",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"300",computed:!1}},showLabels:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};export{E as S};
