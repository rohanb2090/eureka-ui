import{j as s}from"./jsx-runtime-BYYWji4R.js";import{r as l}from"./index-ClcD9ViR.js";import{c as C}from"./cn-CytzSlOG.js";const I=["var(--action-primary)","var(--status-success)","var(--status-warning)","var(--status-error)","var(--status-info)"];function R(f){const{data:a,variant:n="pie"}=f,[g,m]=l.useState(null),o=l.useMemo(()=>a.reduce((e,t)=>e+t.value,0),[a]),c=l.useMemo(()=>{if(o===0)return[];let e=-90;return a.map((t,L)=>{const T=t.value/o*100,M=t.value/o*360,P=e,$=e+M,r=100,i=n==="donut"?60:0,h=P*Math.PI/180,x=$*Math.PI/180,j=100+r*Math.cos(h),w=100+r*Math.sin(h),N=100+r*Math.cos(x),A=100+r*Math.sin(x),y=M>180?1:0;let b;if(n==="donut"){const q=100+i*Math.cos(h),S=100+i*Math.sin(h),D=100+i*Math.cos(x),E=100+i*Math.sin(x);b=[`M ${j} ${w}`,`A ${r} ${r} 0 ${y} 1 ${N} ${A}`,`L ${D} ${E}`,`A ${i} ${i} 0 ${y} 0 ${q} ${S}`,"Z"].join(" ")}else b=["M 100 100",`L ${j} ${w}`,`A ${r} ${r} 0 ${y} 1 ${N} ${A}`,"Z"].join(" ");return e=$,{startAngle:P,endAngle:$,value:t.value,percentage:T,label:t.label,color:t.color||I[L%I.length],path:b}})},[a,o,n]),u=l.useCallback(e=>{m(e)},[]),d=l.useCallback(()=>{m(null)},[]),v=l.useCallback(e=>{const t=c[e];return{tabIndex:0,role:"graphics-symbol","aria-label":`${t.label}: ${t.value} (${t.percentage.toFixed(1)}%)`,onMouseEnter:()=>u(e),onMouseLeave:d,onFocus:()=>u(e),onBlur:d}},[c,u,d]),p=l.useMemo(()=>({role:"img","aria-label":`${n==="donut"?"Donut":"Pie"} chart with ${a.length} segments`}),[a.length,n]);return{segments:c,total:o,chartProps:p,getSegmentProps:v,hoveredIndex:g}}function k({data:f,variant:a="pie",size:n=200,showLabels:g=!0,showPercentages:m=!0,className:o}){const{segments:c,total:u,chartProps:d,getSegmentProps:v,hoveredIndex:p}=R({data:f,variant:a});return s.jsxs("div",{className:C("inline-flex flex-col items-center gap-4",o),children:[s.jsxs("svg",{...d,width:n,height:n,viewBox:"0 0 200 200",className:"select-none",children:[c.map((e,t)=>s.jsx("path",{...v(t),d:e.path,fill:e.color,className:C("transition-opacity cursor-pointer","focus:outline-none focus:ring-2 focus:ring-border-focus",p!==null&&p!==t&&"opacity-50"),style:{transform:p===t?"scale(1.05)":"scale(1)",transformOrigin:"100px 100px",transition:"transform 200ms, opacity 200ms"}},`segment-${t}`)),a==="donut"&&s.jsx("text",{x:"100",y:"105",textAnchor:"middle",className:"text-2xl font-bold pointer-events-none",fill:"var(--text-primary)",children:u})]}),g&&s.jsx("div",{className:"flex flex-wrap gap-3 justify-center max-w-xs",children:c.map((e,t)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:e.color}}),s.jsxs("span",{className:"text-sm text-text-secondary",children:[e.label,m&&s.jsxs("span",{className:"text-text-tertiary ml-1",children:["(",e.percentage.toFixed(1),"%)"]})]})]},`legend-${t}`))})]})}k.__docgenInfo={description:"",methods:[],displayName:"PieChart",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"PieChartDataPoint"}],raw:"PieChartDataPoint[]"},description:""},variant:{required:!1,tsType:{name:"union",raw:"'pie' | 'donut'",elements:[{name:"literal",value:"'pie'"},{name:"literal",value:"'donut'"}]},description:"",defaultValue:{value:"'pie'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},size:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"200",computed:!1}},showLabels:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showPercentages:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};export{k as P};
