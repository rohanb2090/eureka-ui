import{j as r}from"./jsx-runtime-BYYWji4R.js";import{r as u}from"./index-ClcD9ViR.js";import{c as T}from"./cn-CytzSlOG.js";import{u as R}from"./useChartTheme-DtcSC9jR.js";const L=["var(--action-primary)","var(--status-success)","var(--status-warning)","var(--status-error)","var(--status-info)"];function k(v){const{data:n,variant:o="pie"}=v,[g,h]=u.useState(null),c=u.useMemo(()=>n.reduce((t,s)=>t+s.value,0),[n]),a=u.useMemo(()=>{if(c===0)return[];let t=-90;return n.map((s,e)=>{const l=s.value/c*100,j=s.value/c*360,w=t,b=t+j,i=100,m=o==="donut"?60:0,f=w*Math.PI/180,x=b*Math.PI/180,C=100+i*Math.cos(f),N=100+i*Math.sin(f),A=100+i*Math.cos(x),I=100+i*Math.sin(x),P=j>180?1:0;let M;if(o==="donut"){const q=100+m*Math.cos(f),E=100+m*Math.sin(f),D=100+m*Math.cos(x),F=100+m*Math.sin(x);M=[`M ${C} ${N}`,`A ${i} ${i} 0 ${P} 1 ${A} ${I}`,`L ${D} ${F}`,`A ${m} ${m} 0 ${P} 0 ${q} ${E}`,"Z"].join(" ")}else M=["M 100 100",`L ${C} ${N}`,`A ${i} ${i} 0 ${P} 1 ${A} ${I}`,"Z"].join(" ");return t=b,{startAngle:w,endAngle:b,value:s.value,percentage:l,label:s.label,color:s.color||L[e%L.length],path:M}})},[n,c,o]),d=u.useCallback(t=>{h(t)},[]),p=u.useCallback(()=>{h(null)},[]),y=u.useCallback(t=>{const s=a[t];return{tabIndex:0,role:"graphics-symbol","aria-label":`${s.label}: ${s.value} (${s.percentage.toFixed(1)}%)`,onMouseEnter:()=>d(t),onMouseLeave:p,onFocus:()=>d(t),onBlur:p}},[a,d,p]),$=u.useMemo(()=>({role:"img","aria-label":`${o==="donut"?"Donut":"Pie"} chart with ${n.length} segments`}),[n.length,o]);return{segments:a,total:c,chartProps:$,getSegmentProps:y,hoveredIndex:g}}function V({data:v,variant:n="pie",size:o=200,showLabels:g=!0,showPercentages:h=!0,className:c}){const a=R(),{segments:d,total:p,chartProps:y,getSegmentProps:$,hoveredIndex:t}=k({data:v,variant:n}),s=e=>e?e.includes("var(--action-primary)")?a.actionPrimary:e.includes("var(--status-success)")?a.statusSuccess:e.includes("var(--status-warning)")?a.statusWarning:e.includes("var(--status-error)")?a.statusError:e.includes("var(--status-info)")?a.statusInfo:e:a.chart1;return r.jsxs("div",{className:T("inline-flex flex-col items-center gap-4",c),children:[r.jsxs("svg",{...y,width:o,height:o,viewBox:"-5 -5 210 210",className:"select-none",children:[d.map((e,l)=>r.jsx("path",{...$(l),d:e.path,fill:s(e.color),className:T("transition-opacity cursor-pointer","focus:outline-none focus:ring-2 focus:ring-border-focus",t!==null&&t!==l&&"opacity-50"),style:{transform:t===l?"scale(1.05)":"scale(1)",transformOrigin:"100px 100px",transition:"transform 200ms, opacity 200ms"}},`segment-${l}`)),n==="donut"&&r.jsx("text",{x:"100",y:"105",textAnchor:"middle",className:"text-2xl font-bold pointer-events-none",fill:a.textPrimary,style:{fontFamily:"inherit"},children:p})]}),g&&r.jsx("div",{className:"flex flex-wrap gap-3 justify-center max-w-xs",children:d.map((e,l)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3",style:{backgroundColor:e.color}}),r.jsxs("span",{className:"text-sm text-text-secondary",children:[e.label,h&&r.jsxs("span",{className:"text-text-tertiary ml-1",children:["(",e.percentage.toFixed(1),"%)"]})]})]},`legend-${l}`))})]})}V.__docgenInfo={description:"",methods:[],displayName:"PieChart",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"PieChartDataPoint"}],raw:"PieChartDataPoint[]"},description:""},variant:{required:!1,tsType:{name:"union",raw:"'pie' | 'donut'",elements:[{name:"literal",value:"'pie'"},{name:"literal",value:"'donut'"}]},description:"",defaultValue:{value:"'pie'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:""},size:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"200",computed:!1}},showLabels:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},showPercentages:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};export{V as P};
